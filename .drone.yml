kind: pipeline
type: docker
name: default
platform:
  os: linux
  arch: amd64
steps:
- name: publish
  pull: if-not-exists 
  image: plugins/docker
  settings:
    insecure: true
    username: 
      from_secret: username
    password:
      from_secret: password 
    registry: registry.cn-hangzhou.aliyuncs.com
    repo: registry.cn-hangzhou.aliyuncs.com/maximlab/python
    dockerfile: Dockerfile
    tags: cos
- name: email
  image: drillster/drone-email
  settings:
    from: info@maximlab.cn
    host:
      from_secret: email_host
    port: 465
    username:
      from_secret: email_username
    password:
      from_secret: email_password
    recipients:
      - quxiaorui@qq.com
  when:
    status: [success,changed,failure]
    branch: [master]
